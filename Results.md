# Results


| Split | Training | Val | Test |
|-------|----------|-----|------|
|       | 60       | 20  | 20   |
| X     | 70       | 15  | 15   |
|       | 80       | 10  | 10   |
| todo  | 70       | 0   | 30   |


| Dataset  | Size  | Black Hair | Blond Hair | Brown Hair | Gray Hair |
|----------|-------|------------|------------|------------|-----------|
| Train    | 13670 |  4801      |  4470      |      3552  |        847| 
| Val      | 2929  |  1061      |  991       |      672   |        205|
| Test     | 2929  |  1060      |  1031      |      648   |        190|
|----------|-------|------------|------------|------------|-----------|
| Sum      | 19528 |    6922    | 6492       |     4872   |      1242 |


| Dataset  | Size  | Smiling | Not Smiling | 
|----------|-------|---------|-------------|
| Train    | 21000 |  9810   |   11190     |
| Val      |  4500 |  2176   |   2324      |
| Test     |  4500 |  2106   |   2394      |
|----------|-------|---------|-------------|
| Sum      | 30000 | 14092   |  15908      |


| Dataset  | Size  | Male | Female | 
|----------|-------|------|--------|
| Train    | 21000 | 7254 | 13746  |
| Val      | 3500  | 1904 |  2596  |
| Test     | 3500  | 1899 |  2601  |
|----------|-------|------|--------|
| Sum      | 30000 | 11057| 18943  |

----------------------------------------------------------------------------------------------

|||||                                   framework / Smiling                                      ||||||
|----------|------------|--------|--------|---------|-------|--------|--------|------------|----------|
| Network  | Resolution | LR/SGD | #Batch | #Epochs | Train | Val    | Test   | Time [min] | Comments |
| ResNet50 | 1024x1024  | 0.1    | 1      | 200     |       |        |        |            | original |
| ResNet50 | 512x512    | 0.1    | 2      | 200     |       |        |        |            |          |
| ResNet50 | 256x256    | 0.1    | 4      | 200     |       |        |        |            |          |
| ResNet50 | 128x128    | 0.1    | 16     | 200     |       |        |        |            |          |
| ResNet50 | 64x64      | 0.1    | 64     | 200     |       | 91.40  |        |            |          |
| ResNet50 | 32x32      | 0.1    | 128    | 200     |       | 90.16  |        |            |          |


||||                                    Smiling                               |||||
|--------------|------|---------|---------|---------|---------|---------|---------|
| Attack Model | e    | 32/4075 | 64/4133 | 128/    | 256     | 512     |  1024   |
| FGSM         | 0.03 |  83.49  | 99.97   |         |         |         |         |
| FGSM         | 0.07 |  95.73  | 99.01   |         |         |         |         |
| FGSM         | 0.1  |  99.36  | 97.81   |         |         |         |         |
| FGSM         | 0.15 |  96.59  | 96.75   |         |         |         |         |
| FGSM         | 0.18 |  93.44  | 96.22   |         |         |         |         |
| FGSM         | 0.2  |  95.33  | 96.15   |         |         |         |         |
| FGSM         | 0.25 |  98.56  | 96.60   |         |         |         |         |
| FGSM         | 0.3  |  96.74  | 97.28   |         |         |         |         |
| BIM          | 0.03 |  99.97  | 1.0     |         |         |         |         |
| BIM          | 0.2  |   1.0   | 1.0     |         |         |         |         |
| PGD          | 0.03 |  99.42  | 1.0     |         |         |         |         |
| PGD          | 0.2  |   1.0   | 1.0     |         |         |         |         |
| Deepfool     |      |   1.0   | 1.0     |         |         |         |         |
| C&W          |      |   1.0   | 1.0     |         |         |         |         |


||||                                    Smiling                                 |||||
|--------------|------|---------|---------|---------|---------|---------|-----------|
| Attack Model | e    | 32/4075 | 64/4133 | 128/    | 256     | 512     |  1024     |
| FGSM         | 0.01 | 41.32   | 90.53   |         |         |         |           |
| BIM          | 0.01 | 60.80   | 1.0     |         |         |         |           |
| PGD          | 0.01 | 50.45   | 99.70   |         |         |         |           |


||||                                    Smiling                                 |||||
|--------------|------|---------|---------|---------|---------|---------|-----------|
| Attack Model | e    | 32/4075 | 64/4133 | 128/    | 256     | 512     |  1024     |
| FGSM         |0.001 | 03.63   | 08.08   |         |         |         |           |
| BIM          |0.001 | 03.68   | 08.37   |         |         |         |           |
| PGD          |0.001 | 03.21   | 07.23   |         |         |         |           |




---------------------------------------------------------------------------------------------

|||||             framework / Hair Color                                                        ||||||
|----------|------------|--------|--------|-----------|-------|-------|------|------------|----------|
| Network  | Resolution | LR/SGD | #Batch | #Epochs   | Train | Val   | Test | Time [min] | Comments |
| ResNet50 | 1024x1024  | 0.1    | 1      | 200       |       |       |      |            | original |
| ResNet50 | 512x512    | 0.1    | 2      | 200       |       |       |      |            |          |
| ResNet50 | 256x256    | 0.1    | 4      | 150       |       |       |      |            |          |
| ResNet50 | 128x128    | 0.1    | 16     | 150       |       |       |      |            |          |
| ResNet50 | 64x64      | 0.1    | 64     | 150       |       | 98.29 |      |            |  ext     |
| ResNet50 | 32x32      | 0.1    | 128    | 200       |       | 96.14 |      |            |  ext     |


||||                                    Hair Color                              |||||
|--------------|------|---------|---------|---------|---------|---------|-----------|
| Attack Model | e    | 32/2578 | 64/2650 | 128/    | 256     | 512     |  1024     |
| FGSM         | 0.03 | 97.16   | 99.66   |         |         |         |           |
| BIM          | 0.03 | 1.0     | 1.0     |         |         |         |           |
| PGD          | 0.03 | 99.76   | 1.0     |         |         |         |           |
| Deepfool     |      | 1.0     | 1.0     |         |         |         |           |
| C&W          |      | 1.0     | 1.0     |         |         |         |           |

||||                                    Hair Color                              |||||
|--------------|------|---------|---------|---------|---------|---------|-----------|
| Attack Model | e    | 32/2578 | 64/2650 | 128/    | 256     | 512     |  1024     |
| FGSM         | 0.01 |  61.79  | 97.35   |         |         |         |           |
| BIM          | 0.01 |  74.43  |  1.0    |         |         |         |           |
| PGD          | 0.01 |  64.97  | 99.92   |         |         |         |           |

||||                                    Hair Color                              |||||
|--------------|------|---------|---------|---------|---------|---------|-----------|
| Attack Model | e    | 32/2578 | 64/2650 | 128/    | 256     | 512     |  1024     |
| FGSM         |0.001 |  04.57  | 12.86   |         |         |         |           |
| BIM          |0.001 |  04.61  | 13.69   |         |         |         |           |
| PGD          |0.001 |  04.03  | 11.16   |         |         |         |           |


----------------------------------------------------------------------------------------------

 python attack.py -b 128 -attack fgsm

| Dataset | Attack method | e    | Attack Success Rate |
|---------|---------------|------|---------------------|
| Smiling | FGSM          | 0.07 |      0.9973         |
| 32x32   | BIM           | 0.07 |      1.0            |
|         | PGD           | 0.07 |      1.0            |
|         | Deepfool      |      |      1.0            |
|         | C&W           |      |      1.0            |

| Dataset | Attack method | e    | Attack Success Rate |
|---------|---------------|------|---------------------|
| Smiling | FGSM          | 0.03 |      90.52          |
| 64x64   | BIM           | 0.03 |      1.0            |
|         | PGD           | 0.03 |      1.0            |
|         | Deepfool      |      |      1.0            |
|         | C&W           |      |      1.0            |

python attack.py -b 64 -attack fgsm 

| Dataset | Attack method | e    | Attack Success Rate |
|---------|---------------|------|---------------------|
| Smiling | FGSM          | 0.03 |     0.9939          |
| 128x128 | BIM           | 0.03 |     1.0             |
|         | PGD           | 0.03 |     1.0             |
|         | Deepfool      |      |     1.0             |
|         | C&W           |      |     1.0             |

python attack.py -b 4 -attack fgsm 

| Dataset | Attack method | e    | Attack Success Rate |
|---------|---------------|------|---------------------|
| Smiling | FGSM          | 0.01 |     0.7730          |
| 256x256 | BIM           | 0.03 |     1.0             |
|         | PGD           | 0.03 |     1.0             |
|         | Deepfool      |      |     1.0             |
|         | C&W           |      |                     |


| Dataset | Attack method | e    | Attack Success Rate |
|---------|---------------|------|---------------------|
| Smiling | FGSM          | 0.01 |                     |
| 512x512 | BIM           | 0.03 |                     |
|         | PGD           | 0.03 |                     |
|         | Deepfool      |      |                     |
|         | C&W           |      |                     |

| Dataset | Attack method | e    | Attack Success Rate |
|---------|---------------|------|---------------------|
| Smiling | FGSM          | 0.01 |                     |
|1024x1024| BIM           | 0.03 |                     |
|         | PGD           | 0.03 |                     |
|         | Deepfool      |      |                     |
|         | C&W           |      |                     |

python extract_characteristics.py -detector InputMFS -attack fgsm
python detect_adversarials.py     -detector InputMFS -attack fgsm

| Dataset | Attack  | e    | AUC   | Accuracy | Precision | Recall | F1     |
|---------|---------|------|-------|----------|-----------|--------|--------|
| Smiling | FGSM    | 0.07 | 98.97 | 95.55    |  95.27    | 95.85  | 0.9556 |
| 32x32   | BIM     | 0.07 | 96.47 | 91.85    |  90.95    | 92.94  | 0.9194 |
|  norm   | PGD     | 0.07 | 93.24 | 87.04    |  88.69    | 84.91  | 0.8676 |
|         | Deepfool|      | 55.35 | 53.28    |  53.70    | 47.69  | 0.5052 |
|         | C&W     |      | 51.10 | 50.67    |  50.63    | 53.65  | 0.5209 |


| Dataset | Attack  | e    | AUC   | Accuracy | Precision | Recall | F1     |
|---------|---------|------|-------|----------|-----------|--------|--------|
| Smiling | FGSM    | 0.03 | 91.03 | 84.2     |  84.66    |  83.53 | 0.8409 |
| 64x64   | BIM     | 0.03 | 83.23 | 77.1     |  78.01    |  75.48 | 0.7673 |
|  norm   | PGD     | 0.03 | 80.72 | 74.52    |  74.82    |  73.92 | 0.7437 |
|         | Deepfool|      | 51.89 | 51.38    |  51.59    |  44.59 | 0.4784 |
|         | C&W     |      | 50.55 | 50.06    |  50.06    |  45.79 | 0.4783 |

python extract_characteristics.py -net resnet50 -b 64 -detector InputMFS -attack df
python detect_adversarials.py -b 64 -attack pgd -detector InputMFS

| Dataset | Attack  | e    | AUC   | Accuracy | Precision | Recall | F1     |
|---------|---------|------|-------|----------|-----------|--------|--------|
| Smiling | FGSM    | 0.03 | 97.02 |  92.61   |  92.61    | 92.61  | 0.9260 |
| 128x128 | BIM     | 0.03 | 93.68 |  87.65   |  88.34    | 86.75  | 0.8753 |
|  norm   | PGD     | 0.03 | 88.72 |  81.99   |  82.74    | 80.84  | 0.8177 |
|         | Deepfool|      | 50.35 |  50.06   |  50.06    | 47.47  | 0.4873 |
|         | C&W     |      | 50.43 |  50.24   |  50.27    | 43.98  | 0.4691 |

| Dataset | Attack  | e    | AUC   | Accuracy | Precision | Recall | F1     |
|---------|---------|------|-------|----------|-----------|--------|--------|
| Smiling | FGSM    | 0.03 | 73.52 |  67.66   |  67.60    | 67.82  | 0.6771 |
| 256x256 | BIM     | 0.03 | 93.88 |  89.5    |  87.63    | 91.99  | 0.8976 |
|  norm   | PGD     | 0.03 | 89.25 |  84.77   |  83.98    | 85.92  | 0.8494 |
|         | Deepfool|      | 50.21 |  50.18   |  50.19    | 47.82  | 0.4897 |
|         | C&W     |      |       |          |           |        |        |

| Dataset | Attack  | e    | AUC   | Accuracy | Precision | Recall | F1     |
|---------|---------|------|-------|----------|-----------|--------|--------|
| Smiling | FGSM    | 0.03 |       |          |           |        |        |
| 512x512 | BIM     | 0.03 |       |          |           |        |        |
|  norm   | PGD     | 0.03 |       |          |           |        |        |
|         | Deepfool|      |       |          |           |        |        |
|         | C&W     |      |       |          |           |        |        |

| Dataset | Attack  | e    | AUC   | Accuracy | Precision | Recall | F1     |
|---------|---------|------|-------|----------|-----------|--------|--------|
| Smiling | FGSM    | 0.03 |       |          |           |        |        |
|1024x1024| BIM     | 0.03 |       |          |           |        |        |
|  norm   | PGD     | 0.03 |       |          |           |        |        |
|         | Deepfool|      |       |          |           |        |        |
|         | C&W     |      |       |          |           |        |        |

| Dataset | Attack  | e    | AUC   | Accuracy | Precision | Recall | F1     |
|---------|---------|------|-------|----------|-----------|--------|--------|
| Smiling | FGSM    | 0.2  | 100.0 |  99.87   |  99.74    | 100.0  | 0.9987 |
| 32x32   | BIM     | 0.2  | 100.0 |  99.69   |  99.39    | 100.0  | 0.9969 |
| !norm   | PGD     | 0.2  | 100.0 |  99.57   |  99.39    | 99.75  | 0.9957 |
|         | Deepfool|      | 79.9  |  73.19   |  75.07    | 69.45  | 0.7215 |
|         | C&W     |      | 51.11 |  51.10   |  51.15    | 48.96  | 0.5003 |

| Dataset | Attack  | e    | AUC   | Accuracy | Precision | Recall | F1     |
|---------|---------|------|-------|----------|-----------|--------|--------|
| Smiling | FGSM    | 0.07 | 99.78 |  99.03   |  98.91    | 99.15  | 0.9903 |
| 64x64   | BIM     | 0.03 | 85.95 |  78.54   |  80.39    | 75.49  | 0.7786 |
| !norm   | PGD     | 0.03 | 81.1  |  74.0    |  74.36    | 73.28  | 0.7381 |
|         | Deepfool|      | 52.82 |  52.13   |  52.37    | 47.2   | 0.4965 |
|         | C&W     |      | 51.04 |  50.6    |  50.62    | 48.97  | 0.4978 |

python extract_characteristics.py -net resnet50 -b 128 -detector InputPFS -attack fgsm
python detect_adversarials.py   -b 128 -detector InputPFS -attack fgsm

| Dataset | Attack  | e    | AUC   | Accuracy | Precision | Recall | F1     |
|---------|---------|------|-------|----------|-----------|--------|--------|
| Smiling | FGSM    | 0.07 | 78.35 |  71.59   |  72.18    |  70.24 | 0.7119  |
| 32x32   | BIM     | 0.07 | 94.92 |  89.23   |  91.08    |  86.98 | 0.8898  |
|  norm   | PGD     | 0.07 | 92.03 |  85.16   |  87.73    |  81.75 | 0.8463  |
|         | Deepfool|      | 68.92 |  63.56   |  64.73    |  59.61 | 0.6206  |
|         | C&W     |      | 53.49 |  51.95   |  51.95    |  51.82 | 0.5188  |

| Dataset | Attack  | e    | AUC   | Accuracy | Precision | Recall | F1     |
|---------|---------|------|-------|----------|-----------|--------|--------|
| Smiling | FGSM    | 0.03 | 71.57 |   65.6   |   67.83   | 59.36  | 0.6331 |
| 64x64   | BIM     | 0.03 | 85.46 |   77.7   |   80.28   | 73.44  | 0.7671 |
|  norm   | PGD     | 0.03 | 83.87 |   76.44  |   78.72   | 72.48  | 0.7547 |
|         | Deepfool|      | 56.98 |   55.41  |   55.46   | 54.93  | 0.5519 |
|         | C&W     |      | 52.05 |   51.8   |   51.87   | 49.88  | 0.5086 |

| Dataset | Attack  | e    | AUC   | Accuracy | Precision | Recall | F1     |
|---------|---------|------|-------|----------|-----------|--------|--------|
| Smiling | FGSM    | 0.03 | 85.13 |  76.67   | 78.72     | 73.09  | 0.7580 |
| 128x128 | BIM     | 0.03 | 99.32 |  96.39   | 98.12     | 94.58  | 0.9632 |
|  norm   | PGD     | 0.03 | 99.35 |  96.14   | 97.64     | 94.58  | 0.9608 |
|         | Deepfool|      | 55.53 |  53.37   | 53.36     | 53.61  | 0.5348 |
|         | C&W     |      | 55.38 |  54.04   | 54.01     | 54.34  | 0.5417 |

| Dataset | Attack  | e    | AUC   | Accuracy | Precision | Recall | F1     |
|---------|---------|------|-------|----------|-----------|--------|--------|
| Smiling | FGSM    | 0.03 | 73.98 |  68.29   |  68.64    | 67.35  | 0.6799 |
| 256x256 | BIM     | 0.03 | 99.47 |  96.84   |  99.10    | 94.54  | 0.9677 |
|  norm   | PGD     | 0.03 | 99.83 |  97.57   |  99.24    | 95.87  | 0.9753 |
|         | Deepfool|      | 57.92 |  55.46   |  55.55    | 54.61  | 0.5508 |
|         | C&W     |      |       |          |           |        |        |

| Dataset | Attack  | e    | AUC   | Accuracy | Precision | Recall | F1     |
|---------|---------|------|-------|----------|-----------|--------|--------|
| Smiling | FGSM    | 0.03 |       |          |           |        |        |
| 512x512 | BIM     | 0.03 |       |          |           |        |        |
|  norm   | PGD     | 0.03 |       |          |           |        |        |
|         | Deepfool|      |       |          |           |        |        |
|         | C&W     |      |       |          |           |        |        |

| Dataset | Attack  | e    | AUC   | Accuracy | Precision | Recall | F1     |
|---------|---------|------|-------|----------|-----------|--------|--------|
| Smiling | FGSM    | 0.03 |       |          |           |        |        |
|1024x1024| BIM     | 0.03 |       |          |           |        |        |
|  norm   | PGD     | 0.03 |       |          |           |        |        |
|         | Deepfool|      |       |          |           |        |        |
|         | C&W     |      |       |          |           |        |        |

| Dataset | Attack  | e    | AUC   | Accuracy | Precision | Recall | F1     |
|---------|---------|------|-------|----------|-----------|--------|--------|
| Smiling | FGSM    | 0.2  | 86.59 | 78.96    | 83.0      | 72.84  | 0.7759 |
| 32x32   | BIM     | 0.2  | 99.43 | 96.38    | 96.4      | 96.32  | 0.9638 |
| !norm   | PGD     | 0.2  | 99.47 | 96.44    | 96.9      | 95.95  | 0.9642 |
|         | Deepfool|      | 74.04 | 67.18    | 66.9      | 67.98  | 0.6796 |
|         | C&W     |      | 52.27 | 52.21    | 52.2      | 52.39  | 0.5222 |
      
| Dataset | Attack  | e    | AUC   | Accuracy | Precision | Recall | F1     |
|---------|---------|------|-------|----------|-----------|--------|--------|
| Smiling | FGSM    | 0.07 | 89.97 | 82.18    | 81.9      | 82.6   | 0.8225 |
| 64x64   | BIM     | 0.03 | 93.21 | 85.49    | 85.66     | 85.24  | 0.8509 |
| !norm   | PGD     | 0.03 | 92.31 | 84.04    | 85.14     | 82.47  | 0.8376 |
|         | Deepfool|      | 57.38 | 55.3     | 55.36     | 54.76  | 0.5477 |
|         | C&W     |      | 52.97 | 52.36    | 52.38     | 51.87  | 0.5195 |
      

python extract_characteristics.py -net resnet50 -b 128 -detector LayerMFS -attack fgsm
python detect_adversarials.py   -b 128 -detector LayerMFS -attack fgsm

| Dataset | Attack  | e    | AUC   | Accuracy | Precision | Recall | F1     |
|---------|---------|------|-------|----------|-----------|--------|--------|
| Smiling | FGSM    | 0.07 | 99.73 |  97.99   |  97.47    | 98.54  | 0.9799 |
| 32x32   | BIM     | 0.07 | 99.65 |  97.38   |  97.10    | 97.69  | 0.9739 |
|  norm   | PGD     | 0.07 | 99.01 |  95.01   |  94.58    | 95.50  | 0.9503 |
|         | Deepfool|      | 77.35 |  70.01   |  71.23    | 67.15  | 0.6913 |
|         | C&W     |      | 60.8  |  57.91   |  56.81    | 65.94  | 0.6104 |


| Dataset | Attack  | e    | AUC   | Accuracy | Precision | Recall | F1     |
|---------|---------|------|-------|----------|-----------|--------|--------|
| Smiling | FGSM    | 0.03 | 97.97 |  92.5    |  92.66    | 92.3   | 0.9248 |
| 64x64   | BIM     | 0.03 | 96.81 |  91.29   |  92.67    | 89.66  | 0.9114 |
|  norm   | PGD     | 0.03 | 95.54 |  89.48   |  90.70    | 87.98  | 0.8932 |
|         | Deepfool|      | 69.32 |  63.46   |  63.27    | 64.18  | 0.6372 |
|         | C&W     |      | 59.76 |  56.19   |  55.93    | 58.41  | 0.5714 |

| Dataset | Attack  | e    | AUC   | Accuracy | Precision | Recall | F1     |
|---------|---------|------|-------|----------|-----------|--------|--------|
| Smiling | FGSM    |      | 99.98 |  99.21   |  98.91    | 99.52  | 0.9921 |
| 128x128 | BIM     |      | 99.99 |  99.52   |  99.39    | 99.64  | 0.9951 |
|  norm   | PGD     |      | 99.97 |  99.28   |  99.15    | 99.4   | 0.9927 |
|         | Deepfool|      | 61.34 |  58.07   |  57.37    | 62.77  | 0.5995 |
|         | C&W     |      | 61.74 |  59.22   |  58.58    | 62.89  | 0.6066 |

| Dataset | Attack  | e    | AUC   | Accuracy | Precision | Recall | F1     |
|---------|---------|------|-------|----------|-----------|--------|--------|
| Smiling | FGSM    | 0.03 |       |          |           |        |        |
| 256x256 | BIM     | 0.03 |       |          |           |        |        |
|  norm   | PGD     | 0.03 |       |          |           |        |        |
|         | Deepfool|      |       |          |           |        |        |
|         | C&W     |      |       |          |           |        |        |


| Dataset | Attack  | e    | AUC   | Accuracy | Precision | Recall | F1     |
|---------|---------|------|-------|----------|-----------|--------|--------|
| Smiling | FGSM    | 0.03 |       |          |           |        |        |
| 512x512 | BIM     | 0.03 |       |          |           |        |        |
|  norm   | PGD     | 0.03 |       |          |           |        |        |
|         | Deepfool|      |       |          |           |        |        |
|         | C&W     |      |       |          |           |        |        |

| Dataset | Attack  | e    | AUC   | Accuracy | Precision | Recall | F1     |
|---------|---------|------|-------|----------|-----------|--------|--------|
| Smiling | FGSM    | 0.03 |       |          |           |        |        |
|1024x1024| BIM     | 0.03 |       |          |           |        |        |
|  norm   | PGD     | 0.03 |       |          |           |        |        |
|         | Deepfool|      |       |          |           |        |        |
|         | C&W     |      |       |          |           |        |        |

| Dataset | Attack  | e    | AUC   | Accuracy | Precision | Recall | F1     |
|---------|---------|------|-------|----------|-----------|--------|--------|
| Smiling | FGSM    | 0.2  | 100.0 | 100.0    | 100.0     | 100.0  | 1.0    |
| 32x32   | BIM     | 0.2  | 100.0 | 100.0    | 100.0     | 100.0  | 1.0    |
| !norm   | PGD     | 0.2  | 100.0 | 100.0    | 100.0     | 100.0  | 1.0    |
|         | Deepfool|      | 97.31 | 93.25    | 95.37     | 90.92  | 0.9316 |
|         | C&W     |      | 95.17 | 98.40    | 97.02     | 99.88  | 0.9837 |

| Dataset | Attack  | e    | AUC   | Accuracy | Precision | Recall | F1     |
|---------|---------|------|-------|----------|-----------|--------|--------|
| Smiling | FGSM    | 0.07 | 100.0 | 99.94    |  99.88    |  100.0 | 0.9994 |
| 64x64   | BIM     | 0.03 | 100.0 | 100.0    |  100.0    |  100.0 | 1.0    |
| !norm   | PGD     | 0.03 | 100.0 | 100.0    |  100.0    |  100.0 | 1.0    |
|         | Deepfool|      | 97.92 | 94.02    |  92.87    |  95.37 | 0.9410 |
|         | C&W     |      | 98.89 | 96.67    |  94.57    |  99.03 | 0.9674 |


python extract_characteristics.py -detector LayerPFS -attack fgsm
python detect_adversarials.py -detector LayerPFS -attack fgsm 

| Dataset | Attack  | e    | AUC   | Accuracy | Precision | Recall | F1     |
|---------|---------|------|-------|----------|-----------|--------|--------|
| Smiling | FGSM    | 0.07 | 99.77 |  97.50   |  97.21    |  97.80 | 0.9751 |
| 32x32   | BIM     | 0.07 | 99.60 |  97.08   |  97.31    |  96.84 | 0.9707 |
|  norm   | PGD     | 0.07 | 99.16 |  95.26   |  5.15     |  95.38 | 0.9526 |
|         | Deepfool|      | 77.88 |  70.99   |  70.90    |  71.17 | 0.7104 |
|         | C&W     |      | 62.28 |  58.39   |  57.86    |  61.8  | 0.5976 |

| Dataset | Attack  | e    | AUC   | Accuracy | Precision | Recall | F1     |
|---------|---------|------|-------|----------|-----------|--------|--------|
| Smiling | FGSM    | 0.03 | 99.86 |  98.24   |  98.42    | 98.06  | 0.9824 |
| 64x64   | BIM     | 0.03 | 99.89 |  98.8    |  99.03    | 98.55  | 0.9879 |
|  norm   | PGD     | 0.03 | 99.84 |  98.07   |  97.96    | 98.19  | 0.9807 |
|         | Deepfool|      | 61.48 |  57.95   |  57.57    | 60.48  | 0.5899 |
|         | C&W     |      | 60.46 |  57.23   |  57.02    | 58.67  | 0.5784 |

| Dataset | Attack  | e    | AUC   | Accuracy | Precision | Recall | F1     |
|---------|---------|------|-------|----------|-----------|--------|--------|
| Smiling | FGSM    | 0.03 | 97.61 |  92.63   |  92.23    | 93.09  | 0.9266 |
| 128x128 | BIM     | 0.03 | 97.03 |  91.59   |  92.29    | 90.75  | 0.9151 |
|  norm   | PGD     | 0.03 | 95.66 |  89.06   |  89.06    | 89.06  | 0.8906 |
|         | Deepfool|      | 67.93 |  63.28   |  62.92    | 64.66  | 0.6378 |
|         | C&W     |      | 58.25 |  56.37   |  56.37    | 56.37  | 0.5637 |

| Dataset | Attack  | e    | AUC   | Accuracy | Precision | Recall | F1     |
|---------|---------|------|-------|----------|-----------|--------|--------|
| Smiling | FGSM    | 0.03 |       |          |           |        |        |
| 256x256 | BIM     | 0.03 |       |          |           |        |        |
|  norm   | PGD     | 0.03 |       |          |           |        |        |
|         | Deepfool|      |       |          |           |        |        |
|         | C&W     |      |       |          |           |        |        |


| Dataset | Attack  | e    | AUC   | Accuracy | Precision | Recall | F1     |
|---------|---------|------|-------|----------|-----------|--------|--------|
| Smiling | FGSM    | 0.03 |       |          |           |        |        |
| 512x512 | BIM     | 0.03 |       |          |           |        |        |
|  norm   | PGD     | 0.03 |       |          |           |        |        |
|         | Deepfool|      |       |          |           |        |        |
|         | C&W     |      |       |          |           |        |        |

| Dataset | Attack  | e    | AUC   | Accuracy | Precision | Recall | F1     |
|---------|---------|------|-------|----------|-----------|--------|--------|
| Smiling | FGSM    | 0.03 |       |          |           |        |        |
|1024x1024| BIM     | 0.03 |       |          |           |        |        |
|  norm   | PGD     | 0.03 |       |          |           |        |        |
|         | Deepfool|      |       |          |           |        |        |
|         | C&W     |      |       |          |           |        |        |

| Dataset | Attack  | e    | AUC   | Accuracy | Precision | Recall | F1     |
|---------|---------|------|-------|----------|-----------|--------|--------|
| Smiling | FGSM    | 0.2  | 100.0 | 100.0    | 100.0     | 100.0  | 1.0    |
| 32x32   | BIM     | 0.2  | 100.0 | 100.0    | 100.0     | 100.0  | 1.0    |
| !norm   | PGD     | 0.2  | 100.0 | 100.0    | 100.0     | 100.0  | 1.0    |
|         | Deepfool|      | 97.29 | 92.82    | 93.62     | 91.90  | 0.9281 |
|         | C&W     |      | 99.28 | 98.22    | 96.67     | 99.88  | 0.9825 |

| Dataset | Attack   | e    | AUC   | Accuracy | Precision | Recall | F1     |
|---------|----------|------|-------|----------|-----------|--------|--------|
| Smiling | FGSM     | 0.07 | 100.0 | 99.88    |   99.76   | 100.0  | 0.9987 |
| 64x64   | BIM      | 0.03 | 100.0 | 100.0    |   100.0   | 100.0  | 1.0    |
| !norm   | PGD      | 0.03 | 100.0 | 100.0    |   100.0   | 100.0  | 1.0    |
|         | Deepfool |      | 97.85 | 92.93    |   91.81   | 94.27  | 0.9302 |
|         | C&W      |      | 97.73 | 93.89    |   90.15   | 98.55  | 0.9416 |

python extract_characteristics.py -attack fgsm -detector LID
python detect_adversarials.py     -attack fgsm -detector LID

| Dataset | Attack  | e    | AUC   | Accuracy | Precision | Recall | F1     |
|---------|---------|------|-------|----------|-----------|--------|--------|
| Smiling | FGSM    | 0.07 | 87.52 | 79.82    |  79.63    |  80.12 | 0.7988 |
| 32x32   | BIM     | 0.07 | 92.36 | 87.59    |  85.85    |  90.02 | 0.8789 |
|  norm   | PGD     | 0.07 | 94.07 | 88.5     |  91.26    |  85.16 | 0.8811 |
|         | Deepfool|      | 74.58 | 68.67    |  72.81    |  59.61 | 0.6555 |
|         | C&W     |      | 72.88 | 63.87    |  65.08    |  59.85 | 0.6236 |


| Dataset | Attack  | e    | AUC   | Accuracy | Precision | Recall | F1     |
|---------|---------|------|-------|----------|-----------|--------|--------|
| Smiling | FGSM    | 0.03 | 93.42 |  83.93   |  81.73    |  87.38 | 0.8446 |
| 64x64   | BIM     | 0.03 | 95.77 |  91.89   |  88.08    |  96.88 | 0.9227 |
|  norm   | PGD     | 0.03 | 92.31 |  89.0    |  86.01    |  93.15 | 0.8944 |
|         | Deepfool|      | 65.59 |  59.6    |  59.66    |  59.74 | 0.5969 |
|         | C&W     |      | 66.83 |  60.16   |  60.74    |  57.45 | 0.5904 |

| Dataset | Attack  | e    | AUC   | Accuracy | Precision | Recall | F1     |
|---------|---------|------|-------|----------|-----------|--------|--------|
| Smiling | FGSM    | 0.03 | 100.0 | 100.0    | 100.0     | 100.0  | 1.0    |
| 128x128 | BIM     | 0.03 | 99.91 | 99.94    | 100.0     | 99.88  | 0.9993 |
|  norm   | PGD     | 0.03 | 99.91 | 99.94    | 100.0     | 99.88  | 0.9993 |
|         | Deepfool|      | 86.73 | 76.45    | 74.74     | 79.88  | 0.7722 |
|         | C&W     |      | 86.77 | 74.16    | 74.72     | 73.01  | 0.7385 |

| Dataset | Attack  | e    | AUC   | Accuracy | Precision | Recall | F1     |
|---------|---------|------|-------|----------|-----------|--------|--------|
| Smiling | FGSM    | 0.03 |       |          |           |        |        |
| 256x256 | BIM     | 0.03 |       |          |           |        |        |
|  norm   | PGD     | 0.03 |       |          |           |        |        |
|         | Deepfool|      |       |          |           |        |        |
|         | C&W     |      |       |          |           |        |        |

| Dataset | Attack  | e    | AUC   | Accuracy | Precision | Recall | F1     |
|---------|---------|------|-------|----------|-----------|--------|--------|
| Smiling | FGSM    | 0.03 |       |          |           |        |        |
| 512x512 | BIM     | 0.03 |       |          |           |        |        |
|  norm   | PGD     | 0.03 |       |          |           |        |        |
|         | Deepfool|      |       |          |           |        |        |
|         | C&W     |      |       |          |           |        |        |

| Dataset | Attack  | e    | AUC   | Accuracy | Precision | Recall | F1     |
|---------|---------|------|-------|----------|-----------|--------|--------|
| Smiling | FGSM    | 0.03 |       |          |           |        |        |
|1024x1024| BIM     | 0.03 |       |          |           |        |        |
|  norm   | PGD     | 0.03 |       |          |           |        |        |
|         | Deepfool|      |       |          |           |        |        |
|         | C&W     |      |       |          |           |        |        |

| Dataset | Attack  | e    | AUC   | Accuracy | Precision | Recall | F1     |
|---------|---------|------|-------|----------|-----------|--------|--------|
| Smiling | FGSM    | 0.2  | 100.0 | 100.0    |   100.0   |  100.0 | 1.0    |
| 32x32   | BIM     | 0.2  | 99.98 | 99.88    |   99.88   |  99.88 | 0.9988 |
| !norm   | PGD     | 0.2  | 100.0 | 100.0    |   100.0   |  100.0 | 1.0    |
|         | Deepfool|      | 94.02 | 81.96    |   79.91   |  85.40 | 0.8256 |
|         | C&W     |      | 100.0 | 100.0    |   100.0   |  100.0 | 1.0    |

| Dataset | Attack  | e    | AUC   | Accuracy | Precision | Recall | F1     |
|---------|---------|------|-------|----------|-----------|--------|--------|
| Smiling | FGSM    | 0.07 | 100.0 |   100.0  |   100.0   | 100.0  | 1.0    |
| 64x64   | BIM     | 0.03 | 100.0 |   100.0  |   100.0   | 100.0  | 1.0    |
| !norm   | PGD     | 0.03 | 100.0 |   100.0  |   100.0   | 100.0  | 1.0    |
|         | Deepfool|      | 97.35 |   91.83  |   88.37   | 96.34  | 0.9218 |
|         | C&W     |      | 99.91 |   99.94  |   99.88   | 100.0  | 0.9993  |

python extract_characteristics.py -detector Mahalanobis -attack fgsm
python detect_adversarials.py     -detector Mahalanobis -attack fgsm

| Dataset | Attack  | e    | AUC   | Accuracy | Precision | Recall | F1     |
|---------|---------|------|-------|----------|-----------|--------|--------|
| Smiling | FGSM    | 0.07 | 65.31 | 61.40    |   60.33   |  66.59 | 0.6330 |
| 32x32   | BIM     | 0.07 | 52.71 | 49.15    |   49.09   |  46.11 | 0.4755 |
|  norm   | PGD     | 0.07 | 52.8  | 49.64    |   49.59   |  44.53 | 0.4692 |
|         | Deepfool|      | 58.34 | 56.45    |   56.25   |  58.03 | 0.5713 |
|         | C&W     |      | 53.21 | 52.31    |   52.12   |  56.81 | 0.5437 |


| Dataset | Attack  | e    | AUC   | Accuracy | Precision | Recall | F1     |
|---------|---------|------|-------|----------|-----------|--------|--------|
| Smiling | FGSM    | 0.03 | 86.44 |  80.28   |  81.06    | 79.02  | 0.8002 |
| 64x64   | BIM     | 0.03 | 75.28 |  69.47   |  69.85    | 68.51  | 0.6917 |
|  norm   | PGD     | 0.03 | 71.78 |  66.05   |  65.15    | 68.99  | 0.6702 |
|         | Deepfool|      | 57.6  |  54.75   |  54.82    | 53.97  | 0.5439 |
|         | C&W     |      | 52.76 |  52.1    |  51.99    | 54.93  | 0.5341 |

| Dataset | Attack  | e    | AUC   | Accuracy | Precision | Recall | F1     |
|---------|---------|------|-------|----------|-----------|--------|--------|
| Smiling | FGSM    | 0.03 | 98.39 |  94.12   |   94.07   | 94.18  | 0.9412 |
| 128x128 | BIM     | 0.03 | 99.47 |  96.75   |   96.19   | 97.35  | 0.9677 |
|  norm   | PGD     | 0.03 | 98.39 |  93.55   |   94.46   | 92.53  | 0.9349 |
|         | Deepfool|      | 52.18 |  51.69   |   51.46   | 59.52  | 0.5519 |
|         | C&W     |      | 51.36 |  51.33   |   51.14   | 59.04  | 0.5481 |

| Dataset | Attack  | e    | AUC   | Accuracy | Precision | Recall | F1     |
|---------|---------|------|-------|----------|-----------|--------|--------|
| Smiling | FGSM    | 0.03 | 59.33 |  55.73   |   55.01   | 62.95  | 0.5871 |
| 256x256 | BIM     | 0.03 | 97.24 |  91.69   |   93.31   | 89.81  | 0.9153 |
|  norm   | PGD     | 0.03 | 96.77 |  91.38   |   94.05   | 88.35  | 0.9111 |
|         | Deepfool|      | 53.73 |  54.19   |   53.88   | 58.13  | 0.5593 |
|         | C&W     |      |       |          |           |        |        |


| Dataset | Attack  | e    | AUC   | Accuracy | Precision | Recall | F1     |
|---------|---------|------|-------|----------|-----------|--------|--------|
| Smiling | FGSM    | 0.03 |       |          |           |        |        |
| 512x512 | BIM     | 0.03 |       |          |           |        |        |
|  norm   | PGD     | 0.03 |       |          |           |        |        |
|         | Deepfool|      |       |          |           |        |        |
|         | C&W     |      |       |          |           |        |        |

| Dataset | Attack  | e    | AUC   | Accuracy | Precision | Recall | F1     |
|---------|---------|------|-------|----------|-----------|--------|--------|
| Smiling | FGSM    | 0.03 |       |          |           |        |        |
|1024x1024| BIM     | 0.03 |       |          |           |        |        |
|  norm   | PGD     | 0.03 |       |          |           |        |        |
|         | Deepfool|      |       |          |           |        |        |
|         | C&W     |      |       |          |           |        |        |

| Dataset | Attack  | e    | AUC   | Accuracy | Precision | Recall | F1     |
|---------|---------|------|-------|----------|-----------|--------|--------|
| Smiling | FGSM    | 0.2  | 100.0 |  100.0   |   100.0   | 100.0  | 1.0    |
| 32x32   | BIM     | 0.2  | 99.88 |  99.94   |   100.0   | 99.88  | 0.9994 |
| !norm   | PGD     | 0.2  | 100.0 |  100.0   |   100.0   | 100.0  | 1.0    |
|         | Deepfool|      | 97.81 |  94.05   |   95.44   | 92.52  | 0.9396 |
|         | C&W     |      | 99.94 |  99.26   |   99.14   | 99.39  | 0.9926 |

| Dataset | Attack  | e    | AUC   | Accuracy | Precision | Recall | F1     |
|---------|---------|------|-------|----------|-----------|--------|--------|
| Smiling | FGSM    | 0.07 | 100.0 | 99.9     |  99.88    |  100.0 | 0.9994 |
| 64x64   | BIM     | 0.03 | 99.88 | 99.82    |  99.76    |  99.88 | 0.9982 | 
| !norm   | PGD     | 0.03 | 100.0 | 100.0    |  100.0    |  100.0 | 1.0    |
|         | Deepfool|      | 97.78 | 91.89    |  91.44    |  92.44 | 0.9193 |
|         | C&W     |      | 97.78 | 91.89    |  91.44    |  92.44 | 0.9193 |


----------------------------------------------------------------------------------------------

|||||             framework / Gender                                                          ||||||
|----------|------------|--------|--------|-----------|-------|-------|------|------------|----------|
| Network  | Resolution | LR/SGD | #Batch | #Epochs   | Train | Val   | Test | Time [min] | Comments |
| ResNet50 | 1024x1024  | 0.1    | 1      | 200       |       |       |      |            | original |
| ResNet50 | 512x512    | 0.1    | 2      | 200       |       |       |      |            |          |
| ResNet50 | 256x256    | 0.1    | 4      | 150       |       |       |      |            |          |
| ResNet50 | 128x128    | 0.1    | 16     | 150       |       | 98.20 |      |            |          |
| ResNet50 | 64x64      | 0.1    | 64     | 150       |       | 97.71 |      |            |          |
| ResNet50 | 32x32      | 0.1    | 128    | 150       |       | 96.56 |      | 240        |          |
 

||||                                    Gender                                  |||||
|--------------|------|---------|---------|---------|---------|---------|-----------|
| Attack Model | e    | 32/4357 | 64/4393 | 128/4395| 256     | 512     |  1024     |
| FGSM         | 0.03 | 0.968   | 0.999   | 1.0     |         |         |           |
| BIM          | 0.03 | 1.0     | 1.0     | 1.0     |         |         |           |
| PGD          | 0.03 | 0.999   | 1.0     | 1.0     |         |         |           |
| Deepfool     |      | 1.0     | 1.0     | 1.0     |         |         |           |
| C&W          |      | 1.0     | 1.0     |         |         |         |           |

||||                                   Gender                                    |||||
|--------------|-------|---------|---------|---------|---------|---------|-----------|
| Attack Model | e     | 32/4357 | 64/4393 |128/4395 | 256     | 512     | 1024      |
| FGSM         | 0.01  | 0.547   | 0.843   | 1.0     |         |         |           |
| BIM          | 0.01  | 0.736   | 0.996   | 1.0     |         |         |           |
| PGD          | 0.01  | 0.601   | 0.979   | 1.0     |         |         |           |


||||                                     Gender                                   |||||
|--------------|-------|---------|---------|----------|---------|---------|-----------|
| Attack Model | e     | 32/4357 | 64/4393 | 128/4395 | 256     | 512     | 1024      |
| FGSM         | 0.001 | 0.022   | 0.0341  |  0.0684  |         |         |           |
| BIM          | 0.001 | 0.023   | 0.0348  |  0.0764  |         |         |           |
| PGD          | 0.001 | 0.020   | 0.0312  |  0.0609  |         |         |           |



